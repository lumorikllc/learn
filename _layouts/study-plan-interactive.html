---
layout: default
---

<article class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl sm:rounded-2xl p-4 sm:p-6 md:p-8 text-white mb-6 sm:mb-8">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2">
            <span class="px-3 py-1 bg-white/20 rounded-full text-xs sm:text-sm inline-block w-fit">Interactive Study Plan</span>
            <span class="text-xs sm:text-sm opacity-90">{{ page.date | date: "%B %d, %Y" }}</span>
        </div>
        <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-4">{{ page.title }}</h1>
        <div class="flex flex-wrap gap-3 sm:gap-4">
            <div class="flex items-center space-x-2">
                <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
                <span class="text-sm sm:text-base font-medium">{{ page.modules }} Modules</span>
            </div>
            <div class="flex items-center space-x-2">
                <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span class="text-sm sm:text-base font-medium">{{ page.lessons }} Lessons</span>
            </div>
        </div>
        
        <!-- View Toggle Buttons -->
        <div class="mt-4 flex gap-2">
            <button id="view-knowledge" class="px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors text-sm font-medium">
                üó∫Ô∏è Knowledge Graph
            </button>
            <button id="view-list" class="px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-sm font-medium">
                üìù List View
            </button>
        </div>
    </div>

    <!-- Interactive Visualization Container -->
    <div id="visualization-container" class="mb-6">
        
        <!-- Knowledge Graph View -->
        <div id="knowledge-graph-view" class="bg-gray-900 rounded-xl shadow-sm border border-gray-800 p-4 sm:p-6 md:p-8">
            <!-- Canvas for Knowledge Graph -->
            <canvas id="knowledge-graph-canvas" style="width: 100%; height: 700px; cursor: grab;"></canvas>
            
            <!-- Info Panel -->
            <div id="node-info" class="hidden absolute bottom-4 left-4 bg-gray-800/90 backdrop-blur-sm rounded-lg p-4 max-w-sm">
                <h3 id="node-title" class="text-white font-bold mb-2"></h3>
                <p id="node-description" class="text-gray-300 text-sm"></p>
            </div>
        </div>
        
        <!-- List View (Traditional) - Hidden by default, Light theme -->
        <div id="list-view" class="hidden bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6 md:p-8">
            <div class="prose max-w-none">
                {{ content }}
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="mt-8 sm:mt-12 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl sm:rounded-2xl p-4 sm:p-6 md:p-8 text-center">
        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-3 sm:mb-4">Ready to Start Learning?</h2>
        <p class="text-sm sm:text-base text-gray-600 mb-4 sm:mb-6">Join thousands of learners using Lumorik AI to achieve their goals.</p>
        <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center">
            <a href="https://ai.tutor.lumorik.com" class="px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:shadow-lg transition font-medium text-sm sm:text-base">
                Start Your Journey
            </a>
            <a href="{{ '/' | relative_url }}" class="px-4 sm:px-6 py-2.5 sm:py-3 bg-white text-gray-700 rounded-lg border border-gray-300 hover:border-gray-400 transition font-medium text-sm sm:text-base">
                Browse More Plans
            </a>
        </div>
    </div>
</article>

<!-- Knowledge Graph Visualization Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const canvas = document.getElementById('knowledge-graph-canvas');
    const ctx = canvas.getContext('2d');
    
    // Set canvas size
    function resizeCanvas() {
        canvas.width = canvas.offsetWidth * window.devicePixelRatio;
        canvas.height = canvas.offsetHeight * window.devicePixelRatio;
        ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    
    // Parse study plan data
    const listView = document.getElementById('list-view');
    const studyPlanData = parseStudyPlan(listView.innerHTML);
    
    // Graph state
    let nodes = [];
    let edges = [];
    let camera = { x: 0, y: 0, zoom: 1 };
    let isDragging = false;
    let dragStart = { x: 0, y: 0 };
    let hoveredNode = null;
    let selectedNode = null;
    let animationFrame = null;
    
    // Color scheme similar to reference
    const colors = {
        root: '#10b981',  // Green for main topic
        module: {
            1: '#3b82f6',  // Blue
            2: '#8b5cf6',  // Purple
            3: '#ec4899',  // Pink
            4: '#f59e0b',  // Amber
            5: '#ef4444',  // Red
            6: '#06b6d4',  // Cyan
            7: '#84cc16',  // Lime
            8: '#6366f1'   // Indigo
        },
        subtopic: '#64748b',  // Slate gray
        textbook: '#f97316',  // Orange for textbook-enabled
        edge: '#374151',      // Gray for connections
        text: '#ffffff',      // White text
        background: '#111827' // Dark background
    };
    
    function parseStudyPlan(html) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        const planData = {
            title: "{{ page.title }}",
            modules: []
        };
        
        let currentModule = null;
        let moduleIndex = 0;
        
        // Parse modules and subtopics
        const elements = doc.body.children;
        for (let elem of elements) {
            if (elem.tagName === 'H3' && elem.textContent.includes('Module')) {
                moduleIndex++;
                currentModule = {
                    name: elem.textContent.replace(/Module \d+: /, ''),
                    index: moduleIndex,
                    subtopics: [],
                    description: ''
                };
                planData.modules.push(currentModule);
            } else if (elem.tagName === 'P' && currentModule && !currentModule.subtopics.length) {
                currentModule.description = elem.textContent;
            } else if (elem.tagName === 'UL' && currentModule) {
                const items = elem.querySelectorAll('li');
                items.forEach(item => {
                    const link = item.querySelector('a');
                    currentModule.subtopics.push({
                        name: link ? link.textContent.replace(' üìñ', '') : item.textContent,
                        hasTextbook: link !== null,
                        url: link ? link.href : null
                    });
                });
            }
        }
        
        return planData;
    }
    
    function createGraph(data) {
        nodes = [];
        edges = [];
        
        const canvasWidth = canvas.offsetWidth;
        const canvasHeight = canvas.offsetHeight;
        const centerX = canvasWidth / 2;
        const centerY = canvasHeight / 2;
        
        // Create root node (center)
        const rootNode = {
            id: 'root',
            label: data.title,
            x: centerX,
            y: centerY,
            radius: 40,
            color: colors.root,
            type: 'root'
        };
        nodes.push(rootNode);
        
        // Create module nodes in a circle around root
        const moduleRadius = Math.min(canvasWidth, canvasHeight) * 0.35;
        data.modules.forEach((module, i) => {
            const angle = (i / data.modules.length) * Math.PI * 2 - Math.PI / 2;
            const moduleNode = {
                id: `module-${i}`,
                label: module.name,
                shortLabel: `Module ${module.index}`,
                x: centerX + Math.cos(angle) * moduleRadius,
                y: centerY + Math.sin(angle) * moduleRadius,
                radius: 30,
                color: colors.module[module.index] || colors.module[1],
                type: 'module',
                data: module,
                angle: angle
            };
            nodes.push(moduleNode);
            
            // Connect to root
            edges.push({
                source: rootNode,
                target: moduleNode,
                color: colors.edge,
                width: 2
            });
            
            // Create subtopic nodes around each module
            const subtopicRadius = 120;
            module.subtopics.forEach((subtopic, j) => {
                const subtopicAngle = angle + (j - module.subtopics.length / 2) * 0.25;
                const distance = subtopicRadius + (j % 2) * 20; // Vary distance
                const subtopicNode = {
                    id: `subtopic-${i}-${j}`,
                    label: subtopic.name,
                    x: moduleNode.x + Math.cos(subtopicAngle) * distance,
                    y: moduleNode.y + Math.sin(subtopicAngle) * distance,
                    radius: 15,
                    color: subtopic.hasTextbook ? colors.textbook : colors.subtopic,
                    type: 'subtopic',
                    data: subtopic,
                    parentModule: moduleNode
                };
                nodes.push(subtopicNode);
                
                // Connect to module
                edges.push({
                    source: moduleNode,
                    target: subtopicNode,
                    color: colors.edge,
                    width: 1,
                    dashed: true
                });
            });
            
            // Connect adjacent modules
            if (i > 0) {
                edges.push({
                    source: nodes.find(n => n.id === `module-${i-1}`),
                    target: moduleNode,
                    color: colors.edge,
                    width: 1,
                    dashed: false,
                    curved: true
                });
            }
        });
        
        // Connect last module to first for circular flow
        if (data.modules.length > 1) {
            edges.push({
                source: nodes.find(n => n.id === `module-${data.modules.length-1}`),
                target: nodes.find(n => n.id === 'module-0'),
                color: colors.edge,
                width: 1,
                dashed: false,
                curved: true
            });
        }
    }
    
    function drawGraph() {
        // Clear canvas
        ctx.fillStyle = colors.background;
        ctx.fillRect(0, 0, canvas.width / window.devicePixelRatio, canvas.height / window.devicePixelRatio);
        
        ctx.save();
        ctx.translate(camera.x, camera.y);
        ctx.scale(camera.zoom, camera.zoom);
        
        // Draw edges
        edges.forEach(edge => {
            ctx.strokeStyle = edge.color;
            ctx.lineWidth = edge.width;
            ctx.globalAlpha = 0.6;
            
            if (edge.dashed) {
                ctx.setLineDash([5, 5]);
            } else {
                ctx.setLineDash([]);
            }
            
            ctx.beginPath();
            
            if (edge.curved) {
                // Draw curved edge for module connections
                const dx = edge.target.x - edge.source.x;
                const dy = edge.target.y - edge.source.y;
                const cx = edge.source.x + dx / 2 - dy * 0.2;
                const cy = edge.source.y + dy / 2 + dx * 0.2;
                
                ctx.moveTo(edge.source.x, edge.source.y);
                ctx.quadraticCurveTo(cx, cy, edge.target.x, edge.target.y);
            } else {
                ctx.moveTo(edge.source.x, edge.source.y);
                ctx.lineTo(edge.target.x, edge.target.y);
            }
            
            ctx.stroke();
            ctx.globalAlpha = 1;
        });
        
        ctx.setLineDash([]);
        
        // Draw nodes
        nodes.forEach(node => {
            // Draw node circle
            ctx.fillStyle = node.color;
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = node === hoveredNode ? 3 : 2;
            
            ctx.beginPath();
            ctx.arc(node.x, node.y, node.radius, 0, Math.PI * 2);
            ctx.fill();
            
            if (node === hoveredNode || node === selectedNode) {
                ctx.stroke();
            }
            
            // Draw label
            ctx.fillStyle = colors.text;
            ctx.font = `${node.type === 'root' ? 'bold 14px' : node.type === 'module' ? 'bold 12px' : '10px'} system-ui, -apple-system, sans-serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            if (node.type === 'subtopic') {
                // Draw subtopic labels outside the node
                const labelDistance = node.radius + 15;
                const angle = Math.atan2(node.y - node.parentModule.y, node.x - node.parentModule.x);
                const labelX = node.x + Math.cos(angle) * labelDistance;
                const labelY = node.y + Math.sin(angle) * labelDistance;
                
                // Background for readability
                const metrics = ctx.measureText(node.label);
                ctx.fillStyle = colors.background + 'dd';
                ctx.fillRect(labelX - metrics.width/2 - 2, labelY - 6, metrics.width + 4, 12);
                
                ctx.fillStyle = colors.text;
                ctx.fillText(node.label, labelX, labelY);
                
                // Draw textbook icon if applicable
                if (node.data && node.data.hasTextbook) {
                    ctx.fillText('üìñ', node.x, node.y);
                }
            } else {
                // Draw module/root labels inside
                if (node.shortLabel) {
                    ctx.fillText(node.shortLabel, node.x, node.y);
                } else {
                    // Split long labels
                    const words = node.label.split(' ');
                    const lines = [];
                    let currentLine = '';
                    
                    words.forEach(word => {
                        const testLine = currentLine + (currentLine ? ' ' : '') + word;
                        const metrics = ctx.measureText(testLine);
                        if (metrics.width > node.radius * 2.5 && currentLine) {
                            lines.push(currentLine);
                            currentLine = word;
                        } else {
                            currentLine = testLine;
                        }
                    });
                    if (currentLine) lines.push(currentLine);
                    
                    const lineHeight = 14;
                    const startY = node.y - (lines.length - 1) * lineHeight / 2;
                    lines.forEach((line, i) => {
                        ctx.fillText(line, node.x, startY + i * lineHeight);
                    });
                }
            }
        });
        
        ctx.restore();
    }
    
    function animate() {
        drawGraph();
        animationFrame = requestAnimationFrame(animate);
    }
    
    // Mouse interactions
    canvas.addEventListener('mousedown', (e) => {
        isDragging = true;
        dragStart.x = e.offsetX - camera.x;
        dragStart.y = e.offsetY - camera.y;
        canvas.style.cursor = 'grabbing';
    });
    
    canvas.addEventListener('mousemove', (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX - rect.left - camera.x) / camera.zoom;
        const y = (e.clientY - rect.top - camera.y) / camera.zoom;
        
        if (isDragging) {
            camera.x = e.offsetX - dragStart.x;
            camera.y = e.offsetY - dragStart.y;
        } else {
            // Check for node hover
            hoveredNode = null;
            nodes.forEach(node => {
                const dx = x - node.x;
                const dy = y - node.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < node.radius) {
                    hoveredNode = node;
                    canvas.style.cursor = 'pointer';
                }
            });
            
            if (!hoveredNode) {
                canvas.style.cursor = 'grab';
            }
        }
    });
    
    canvas.addEventListener('mouseup', () => {
        isDragging = false;
        canvas.style.cursor = 'grab';
    });
    
    canvas.addEventListener('click', (e) => {
        if (hoveredNode) {
            selectedNode = hoveredNode;
            showNodeInfo(selectedNode);
        }
    });
    
    canvas.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY > 0 ? 0.9 : 1.1;
        camera.zoom *= delta;
        camera.zoom = Math.max(0.5, Math.min(2, camera.zoom));
    });
    
    function showNodeInfo(node) {
        const infoPanel = document.getElementById('node-info');
        const titleEl = document.getElementById('node-title');
        const descEl = document.getElementById('node-description');
        
        titleEl.textContent = node.label;
        
        if (node.data) {
            if (node.data.description) {
                descEl.textContent = node.data.description;
            } else if (node.data.hasTextbook) {
                descEl.innerHTML = `üìñ Textbook available<br><a href="${node.data.url}" target="_blank" class="text-blue-400 hover:underline">View content</a>`;
            } else {
                descEl.textContent = `${node.type === 'module' ? 'Module' : 'Subtopic'} in the learning path`;
            }
        } else {
            descEl.textContent = 'Central topic of the study plan';
        }
        
        infoPanel.classList.remove('hidden');
    }
    
    // View toggles
    document.getElementById('view-knowledge').addEventListener('click', () => {
        document.getElementById('knowledge-graph-view').classList.remove('hidden');
        document.getElementById('list-view').classList.add('hidden');
        document.getElementById('view-knowledge').classList.add('bg-white/20');
        document.getElementById('view-knowledge').classList.remove('bg-white/10');
        document.getElementById('view-list').classList.add('bg-white/10');
        document.getElementById('view-list').classList.remove('bg-white/20');
    });
    
    document.getElementById('view-list').addEventListener('click', () => {
        document.getElementById('list-view').classList.remove('hidden');
        document.getElementById('knowledge-graph-view').classList.add('hidden');
        document.getElementById('view-list').classList.add('bg-white/20');
        document.getElementById('view-list').classList.remove('bg-white/10');
        document.getElementById('view-knowledge').classList.add('bg-white/10');
        document.getElementById('view-knowledge').classList.remove('bg-white/20');
    });
    
    // Initialize
    createGraph(studyPlanData);
    animate();
});
</script>

<style>
#visualization-container {
    position: relative;
}

#knowledge-graph-canvas {
    background: #111827;
    border-radius: 0.5rem;
}

#node-info {
    backdrop-filter: blur(10px);
}
</style>